# Coca-Cola Stock Forecasting Pipeline

## Overview
This project implements a comprehensive time series forecasting pipeline for Coca-Cola (KO) stock price prediction using 2 years of historical data, moving average smoothing, and statsmodels-based forecasting models.

## Project Structure
```
```
.
├── src/
│   ├── data_pipeline.py       # Data acquisition and preprocessing
│   ├── train_forecast.py      # Model training and forecasting
│   └── main.py                # Main orchestration script
├── models/                     # Saved model artifacts
├── visualizations/             # Generated plots and diagnostics
├── data/                       # Raw and processed datasets
├── run_pipeline.py            # Pipeline execution script
├── run_full_pipeline.py       # Full end-to-end pipeline
└── README.md                  # This file
```
```

## Features
- **Data Acquisition**: Automated download of 2 years of Coca-Cola (KO) historical stock data using yfinance
- **Preprocessing**: Moving average smoothing (20-30 day window) to reduce noise and identify trends
- **Time Series Forecasting**: Statsmodels-based forecasting models (SARIMA/Exponential Smoothing) for 3-month predictions
- **Evaluation Metrics**: MAE, RMSE, and MAPE on holdout test set
- **Visualization**: Publication-ready matplotlib plots with:
  - Raw KO series with moving average overlay
  - Training/test split visualization
  - Forecasts with confidence intervals
  - Residual diagnostics and ACF/PACF plots
- **Experiment Tracking**: End-to-end W&B integration for parameter logging, metric tracking, and artifact management

## Dependencies
- pandas: Data manipulation and time series operations
- numpy: Numerical operations
- matplotlib: Visualization and plotting
- yfinance: Stock data download
- scikit-learn: Preprocessing and evaluation metrics
- statsmodels: ARIMA/exponential smoothing models
- wandb: Experiment tracking and logging

## Quick Start
```bash
python run_full_pipeline.py
```

This will:
1. Download 2 years of Coca-Cola stock data
2. Apply 20-30 day moving average smoothing
3. Train a forecasting model on the data
4. Generate 3-month (60-90 trading days) predictions
5. Evaluate model performance (MAE, RMSE, MAPE)
6. Log all metrics, parameters, and visualizations to W&B
7. Save trained model artifacts

## Configuration
- **Stock Ticker**: KO (Coca-Cola)
- **Historical Period**: 2 years
- **Moving Average Window**: 20-30 days
- **Forecast Horizon**: 3 months (60-90 trading days)
- **Train/Test Split**: Typically 80/20 on time series data
- **W&B Project**: ko-stock-forecasting-pipeline

## Results
Model performance metrics and visualizations are logged to W&B for reproducibility and monitoring. All plots include confidence intervals and diagnostic information.

## Reproducibility
- Deterministic seed management ensures reproducible results across runs
- All hyperparameters and model configurations are logged to W&B
- Trained models are saved as artifacts for future inference

## Author
Generated by the Coca-Cola Stock Forecasting Pipeline Project